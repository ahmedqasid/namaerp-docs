---
lang: ar
---

# أسئلة في موديول التوزيع والمخازن والمبيعات والمشتريات 

إليك نسخة منقحة ومنسقة بشكل احترافي للمحتوى الذي قدمته، مع الحفاظ على جميع المعلومات المهمة:

---

## **هل يمكن منع المستخدم من استلام أو شراء صنف إذا تجاوز الكمية القصوى؟**

نعم، يمكن ذلك من خلال إعدادات النظام، وذلك باستخدام مسارات كيان مخصصة أو التحقق بناءً على معايير.

---

### ✅ **الخيار الأفضل: استخدام مسار الكيان `EAPreventQtyMoreThan`**

* يُستخدم هذا المسار لمنع الحركات (مثل الشراء أو الاستلام) إذا تجاوزت **إجمالي كمية الصنف** في المستند القيمة المحددة في الحقل `maxQuantity` الموجود داخل بطاقة الصنف.

#### 🟢 **استعلام المقارنة:**

```sql
select {details.item.item.defaultDetailData.maxQuantity}
```

> هذا الاستعلام يُستخدم داخل المسار لمقارنة إجمالي الكمية مع الحد الأقصى المسموح به لكل صنف.

---

### ⚠️ **تنبيه مهم:**

::: tip النظام يُجري التحقق على **الكمية المحوّلة للوحدة الصغرى** (الوحدة الأساسية للصنف).

* مثال: إذا كانت الوحدة الصغرى "جرام"، وتم إدخال الكمية بالكيلو، فالنظام سيحوّل الكمية إلى "جرام" قبل المقارنة.
* لذا يُنصح بربط المسار مع **مرحلة ما قبل الحفظ** لضمان تحويل الكمية فعليًا للوحدة الصغرى.
  :::

---

### 🔁 **بديل آخر: مسار `EAPreventQtyLessThan`**

::: tip إذا كنت بحاجة لمنع إدخال كمية **أقل من حد معين**، يمكنك استخدام المسار التالي: `EAPreventQtyLessThan`
:::

---

::: tip ⚙️ **خيار آخر (أقل دقة): التحقق بناءً على معايير**
يمكنك أيضًا تنفيذ التحقق باستخدام **معايير مباشرة** داخل ملفات التحقق، وذلك بمقارنة كمية السطر مع الحقل `maxQuantity` في بطاقة الصنف.

لكن انتبه:

* هذا التحقق يتم **لكل سطر على حدة**.
* إذا تكرر نفس الصنف في أكثر من سطر، لن يتم تجميع الكمية، مما قد يسمح بتجاوز الحد الأقصى عبر عدة سطور.

✅ لهذا السبب، يُفضل استخدام مسار الكيان `EAPreventQtyMoreThan` لأنه يُراعي **إجمالي الكمية** لكل صنف داخل المستند.
:::

## ما هي معالجة الفرق ما بين قيمة مردود المشتريات التي تم استردادها من المورد - وتكلفة الصرف المخزنى الناتج عنها ؟
- يرجى قراءة [هذا المقال](https://www.namasoft.com/ar/article/%d8%a7%d9%84%d8%b9%d8%b1%d8%a8%d9%8a%d8%a9-%d8%a7%d9%84%d9%85%d8%b9%d8%a7%d9%84%d8%ac%d8%a9-%d8%a7%d9%84%d9%85%d8%ad%d8%a7%d8%b3%d8%a8%d9%8a%d8%a9-%d9%84%d9%84%d9%81%d8%b1%d9%82-%d8%a8%d9%8a%d9%86/) لمعرفة تفاصيل المشكلة والحلول المتاحة
- يمكنك معرفة المزيد من خلال الفيديو التالي:
  <iframe width="560" height="315" src="https://www.youtube.com/embed/UXodW-O9wN0?si=JzzcgpmAHhtktXaH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## **هل يمكن ربط صنف بمخزن أو موقع معين، أو بعدة مخازن بحيث يمنع النظام الحركات خارج هذه المخازن؟**

نعم، يمكن ذلك من خلال استخدام ملف <LinkToNewRecord entityType="ItemWarehouseRelation" />

### **الخطوات المطلوبة:**

1. **تفعيل الخيار التالي من إعدادات سلسلة التوريد (Supply Chain):**
<SupplyChainOption option-code="value.activateItemWarehouseRelation" link-title="تفعيل ربط الأصناف بالمخزن" />

2. **إنشاء ملف "ربط أصناف بمخازن":**
   يحتوي هذا الملف على جدول تفاصيل ينقسم إلى قسمين رئيسيين:

   #### **أولاً: تحديد الصنف**

   يمكن تحديد الأصناف باستخدام واحد أو أكثر من المعايير التالية:

  * الصنف نفسه
  * أي من التصنيفات العشر الخاصة بالصنف
  * قسم الصنف
  * أي من الفئات الخمس

   #### **ثانياً: تحديد المخزن أو الموقع ونوع الربط**

  * **المخزن أو الموقع** الذي ترغب في تقييد الحركة معه.
  * **نوع الربط** ويشمل:

    * **السماح بالتعامل**: يسمح بتنفيذ الحركات فقط من المخازن المحددة.
    * **منع التعامل**: يمنع تنفيذ الحركات مع المخازن المحددة.

---

### **أمثلة عملية:**

#### ✅ السماح بالتعامل:

**مثال:** السماح بالتعامل مع الأصناف التي ينتمي قسمها إلى "خامات" بالصرف والتوريد فقط من مخزن "الخامات".

* أدخل "خامات" في حقل **قسم الصنف**.
* أدخل "الخامات" في حقل **المخزن**.
* اختر نوع الربط: **السماح بالتعامل**.

#### ❌ منع التعامل:

**مثال:** منع التعامل مع صنف "حمض الكبريتيك" في مخزن "المنتجات التامة".

* أنشئ سطرًا جديدًا يحتوي على:

  * **الصنف:** حمض الكبريتيك
  * **المخزن:** المنتجات التامة
  * **نوع الربط:** منع التعامل

---

::: warning **تنبيه مهم:**

عند تفعيل الخيار التالي في إعدادات Supply CHain:
<SupplyChainOption option-code="value.itemRelationToWarehouseMustBeSpecified" link-title="يجب تحديد علاقة الأصناف بالمخازن" />
فإن النظام **لن يسمح بالحفظ أو تنفيذ الحركات** إلا إذا كانت هناك علاقة **"سماح بالتعامل"** محددة مسبقًا بين الصنف والمخزن.
:::
