<rtl>

# تسجيل الدخول بالبصمة في نقاط البيع

تخيّل أن لديك عدة موظفين يتناوبون على نفس ماكينة نقاط البيع خلال اليوم. بدلاً من كتابة اسم المستخدم وكلمة المرور في كل مرة، يكفي أن يضع الموظف إصبعه على قارئ البصمة ليتعرّف النظام عليه تلقائياً ويُسجّل دخوله. هذه الميزة تجعل عملية تبديل المستخدمين أسرع وأكثر أماناً.

## كيف تعمل الميزة؟

النظام يستخدم جهاز قارئ بصمات من نوع **Digital Persona URU4500**. عند تسجيل بصمة جديدة، يطلب النظام من المستخدم وضع إصبعه **4 مرات** لضمان دقة التعرّف. بعد التسجيل، تُخزَّن البصمة في قاعدة بيانات نقاط البيع وتُزامَن مع الخادم الرئيسي.

عند ظهور أي شاشة تطلب بيانات الدخول — سواء شاشة تسجيل الدخول الرئيسية، أو نافذة فك القفل، أو نافذة الصلاحيات الأمنية — يبدأ النظام تلقائياً بالاستماع لقارئ البصمة في الخلفية. بمجرد التعرّف على البصمة، يتم تسجيل الدخول مباشرة دون الحاجة لأي إدخال يدوي.

## المتطلبات

قبل استخدام ميزة البصمة، تحتاج إلى تثبيت برنامج التشغيل الخاص بجهاز القارئ:

1. حمّل **Digital Persona SDK** من الرابط التالي:
   `https://github.com/iamonuwa/Digital-Persona-SDK/blob/master/SDK/Install/x64/Setup.exe`
2. ثبّت البرنامج على الجهاز الذي يعمل عليه نقاط البيع.
3. وصّل جهاز قارئ البصمة **Digital Persona URU4500** بمنفذ USB.

::: warning
تأكد من تثبيت SDK قبل تشغيل تطبيق نقاط البيع. إذا لم يكن القارئ موصولاً أو البرنامج غير مثبّت، ستظهر رسالة "لا يوجد قارئ بصمة متاح" عند محاولة التسجيل.
:::

## إعداد الميزة

### الخطوة 1: تفعيل البصمة في إعدادات نقاط البيع

1. افتح ملف **إعدادات نقاط البيع** (POSConfiguration).
2. فعّل خيار **"تفعيل البصمة"** (Enable Fingerprint).
3. احفظ الإعدادات.

هذا الخيار هو المفتاح الرئيسي — بدون تفعيله، لن تعمل أي من ميزات البصمة في النظام، ولن يظهر زر تسجيل البصمة في القائمة.

### الخطوة 2: منح صلاحية تسجيل البصمات

ليس كل مستخدم يجب أن يكون قادراً على تسجيل بصمات الآخرين. لذلك أضفنا صلاحية مخصصة للتحكم في ذلك:

1. افتح **ملف الصلاحيات الأمنية** (POS Security Profile) الخاص بالمستخدم أو المجموعة.
2. فعّل صلاحية **"CanEnrollFingerprints"** (إمكانية تسجيل البصمات).
3. احفظ الملف.

::: tip
يمكنك منح هذه الصلاحية فقط للمشرفين أو مديري الفروع، بحيث يكونون هم المسؤولين عن تسجيل بصمات باقي الموظفين.
:::

## تسجيل بصمة جديدة

بعد الإعداد، أصبح بإمكان المستخدمين المصرّح لهم تسجيل بصمات جديدة. العملية تتم من داخل تطبيق نقاط البيع مباشرة:

1. افتح **القائمة الجانبية**.
2. اذهب إلى **"الإجراءات"** (Actions).
3. اختر **"تسجيل البصمة"** (Fingerprint Enrollment).

ستظهر نافذة التسجيل التي تحتوي على:

### اختيار المستخدم
- في حقل **"المستخدم"**، اختر المستخدم المراد تسجيل بصمته.
- بمجرد اختيار المستخدم، يعرض النظام **البصمات المسجّلة مسبقاً** لهذا المستخدم (إن وُجدت)، مع تاريخ كل بصمة والملاحظات المرفقة بها.
- يمكنك حذف أي بصمة قديمة بالضغط على زر (**✕**) بجانبها.

### إضافة ملاحظة
- في حقل **"الملاحظات"** (Remarks)، أضف وصفاً يساعد المستخدم على تذكّر البصمة — مثلاً: "السبابة اليمنى" أو "الإبهام الأيسر".

### بدء التسجيل
1. اضغط على زر **"بدء التسجيل"** (Start Enrollment).
2. سيطلب منك النظام وضع الإصبع على القارئ **4 مرات**.
3. مع كل مسح ناجح، تتحول إحدى نقاط التقدم إلى اللون الأخضر.
4. إذا كانت جودة المسح ضعيفة، يطلب النظام إعادة المحاولة دون خسارة المسحات الناجحة السابقة.
5. بعد اكتمال المسحات الأربع، تظهر رسالة **"تم تسجيل البصمة بنجاح!"**.

::: info
يمكنك تسجيل أكثر من بصمة لنفس المستخدم — مثلاً بصمة لكل يد. كل بصمة تُسجَّل كسطر منفصل مع ملاحظاتها وتاريخها.
:::

## استخدام البصمة لتسجيل الدخول

بعد تسجيل البصمات، تعمل ميزة التعرّف بالبصمة تلقائياً في ثلاثة مواضع:

### شاشة تسجيل الدخول
عند تشغيل تطبيق نقاط البيع وظهور شاشة تسجيل الدخول، يبدأ النظام فوراً بالاستماع لقارئ البصمة. ضع إصبعك على القارئ والنظام يتعرّف عليك ويُسجّل دخولك مباشرة — لا حاجة لكتابة اسم المستخدم أو كلمة المرور.

### نافذة فك القفل
عندما تكون الشاشة مقفلة ويطلب النظام بيانات الدخول لفك القفل، يمكنك ببساطة وضع إصبعك على القارئ لفك القفل.

### نافذة الصلاحيات الأمنية
عند تنفيذ إجراء يتطلب صلاحية خاصة (مثل منح خصم أو إلغاء فاتورة)، تظهر نافذة تطلب بيانات مستخدم لديه الصلاحية المطلوبة. بدلاً من إدخال البيانات يدوياً، يمكن للمشرف وضع بصمته مباشرة على القارئ.

::: tip
في جميع الحالات الثلاث، يبقى خيار تسجيل الدخول التقليدي (اسم المستخدم وكلمة المرور) متاحاً. البصمة هي طريقة إضافية وليست بديلاً إجبارياً.
:::

## مزامنة البيانات مع الخادم

بيانات البصمات تتبع نفس آلية مزامنة بيانات نقاط البيع مع الخادم الرئيسي:

- عند تسجيل بصمة جديدة أو حذف بصمة موجودة، يُعلّم السجل بأنه **غير مُرسَل** (sent = false).
- يقوم النظام تلقائياً بإرسال البصمات غير المرسلة إلى الخادم ضمن دورة المزامنة الاعتيادية.
- على الخادم، تُحفظ البصمات في ملف **"بصمات المستخدمين"** (User Fingerprint) ضمن النظام الأساسي.
- يتم تسجيل معرّف ملف البصمة في **سجل الإجراءات** (Action History) لأغراض المتابعة والمراجعة.

</rtl>
